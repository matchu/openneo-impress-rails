# Add here your search queries
# see the detailed Source documentation at https://github.com/ddnexus/flex/wiki/Sources


# ANCHORS litheral key: it will not be used as template
# you can store here fragments of queries to reuse in the templates below
ANCHORS:
  - &name_locale_partial
    "name.<<locale>>^<<boost= 1>>"
  - &species_support_id_partial
    term:
      species_support_id: <<species_support_id>>
  - &occupied_zone_id_partial
    terms:
      occupied_zone_id: <<occupied_zone_id>>
  - &restricted_zone_id_partial
    terms:
      restricted_zone_id: <<restricted_zone_id>>

_name_locales:
  *name_locale_partial

_negative_name_locales:
  *name_locale_partial

_species_support_ids:
  *species_support_id_partial

_negative_species_support_ids:
  *species_support_id_partial

_occupied_zone_ids:
  *occupied_zone_id_partial

_negative_occupied_zone_ids:
  *occupied_zone_id_partial

_restricted_zone_ids:
  *restricted_zone_id_partial

_negative_restricted_zone_ids:
  *restricted_zone_id_partial

item_search:
  - query:
      bool:
        must:
          - multi_match:
              query: <<name= ~>>
              fields: <<_name_locales>>
          - term:
              is_nc: <<is_nc= ~>>
          - term:
              is_pb: <<is_pb= ~>>
          - <<_species_support_ids= ~>>
          - <<_occupied_zone_ids= ~>>
          - <<_restricted_zone_ids= ~>>
        must_not:
          - multi_match:
              query: <<negative_name= ~>>
              fields: <<_negative_name_locales>>
          - <<_negative_species_support_ids= ~>>
          - <<_negative_occupied_zone_ids= ~>>
          - <<_negative_restricted_zone_ids= ~>>
    sort:
      - name.<<locale>>.untouched
